<div class="syllabus-content">
  
  <!-- MENSAJES -->
  <div *ngIf="successMessage" class="success-message">
    <mat-icon>check_circle</mat-icon>
    <p>{{ successMessage }}</p>
  </div>

  <div *ngIf="errorMessage" class="error-message">
    <mat-icon>error</mat-icon>
    <p>{{ errorMessage }}</p>
  </div>

  <!-- ===================================== -->
  <!-- SECCI√ìN 1: TEMARIOS (Solo lectura)   -->
  <!-- ===================================== -->
  
  <!-- HEADER DE TEMARIOS -->
  <div class="section-header">
    <mat-icon>description</mat-icon>
    <h2>Temarios Disponibles</h2>
  </div>

  <div class="info-banner">
    <mat-icon>info</mat-icon>
    <p>Los temarios son subidos por el administrador. Puedes descargarlos y basarte en ellos para crear tu planeaci√≥n.</p>
  </div>

  <!-- FILTRO POR MATERIA -->
  <div class="filter-section">
    <mat-form-field appearance="outline">
      <mat-label>Filtrar por Materia</mat-label>
      <mat-select [formControl]="materiaControl">
        <mat-option *ngFor="let materia of materias" [value]="materia">
          {{ materia }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <div class="count-info">
      <mat-icon>folder</mat-icon>
      <span>{{ temariosFiltrados.length }} temario(s) disponible(s)</span>
    </div>
  </div>

  <!-- LISTA DE TEMARIOS -->
  <div class="temarios-grid">
    
    <!-- CARD POR CADA TEMARIO -->
    <mat-card *ngFor="let temario of temariosFiltrados" class="temario-card">
      <mat-card-header>
        <div mat-card-avatar class="pdf-icon">
          <mat-icon>picture_as_pdf</mat-icon>
        </div>
        <mat-card-title>{{ temario.nombreArchivo }}</mat-card-title>
        <mat-card-subtitle>
          <mat-chip class="materia-chip">{{ temario.materia }}</mat-chip>
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <div class="temario-info">
          <div class="info-row">
            <mat-icon>event</mat-icon>
            <span>{{ formatDate(temario.fechaSubida) }}</span>
          </div>
          <div class="info-row">
            <mat-icon>storage</mat-icon>
            <span>{{ temario.tamano }} MB</span>
          </div>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <!-- ‚úÖ SOLO DESCARGAR (docente NO puede eliminar temarios) -->
        <button 
          mat-button 
          color="primary"
          (click)="downloadTemario(temario)">
          <mat-icon>download</mat-icon>
          Descargar Temario
        </button>
        
        <!-- ‚úÖ NUEVO: Subir planeaci√≥n basada en este temario -->
        <button 
          mat-button 
          color="accent"
          (click)="uploadPlaneacion(temario.id, temario.materia)">
          <mat-icon>upload_file</mat-icon>
          Subir Planeaci√≥n
        </button>
      </mat-card-actions>
    </mat-card>

  </div>

  <!-- MENSAJE SI NO HAY TEMARIOS -->
  <div *ngIf="temariosFiltrados.length === 0" class="no-temarios">
    <mat-icon>folder_open</mat-icon>
    <p>No hay temarios disponibles</p>
    <p class="hint">El administrador a√∫n no ha subido temarios para tus materias</p>
  </div>

  <!-- ===================================== -->
  <!-- SECCI√ìN 2: MIS PLANEACIONES          -->
  <!-- ===================================== -->

  <div class="divider"></div>

  <div class="section-header">
    <mat-icon>assignment</mat-icon>
    <h2>Mis Planeaciones</h2>
  </div>

  <!-- INPUT PARA SELECCIONAR ARCHIVO DE PLANEACI√ìN (oculto) -->
  <input 
    type="file" 
    accept=".pdf"
    #fileInput
    (change)="onFileSelected($event)"
    style="display: none;">

  <!-- BARRA DE PROGRESO (Solo se muestra al subir) -->
  <div *ngIf="isUploading" class="upload-progress">
    <mat-progress-spinner 
      mode="determinate" 
      [value]="uploadProgress"
      diameter="50">
    </mat-progress-spinner>
    <span class="progress-text">Subiendo planeaci√≥n... {{ uploadProgress }}%</span>
  </div>

  <!-- LISTA DE MIS PLANEACIONES -->
  <div class="planeaciones-grid" *ngIf="planeaciones.length > 0">
    
    <mat-card *ngFor="let planeacion of planeaciones" class="planeacion-card">
      <mat-card-header>
        <div mat-card-avatar class="planeacion-icon">
          <mat-icon>assignment_turned_in</mat-icon>
        </div>
        <mat-card-title>{{ planeacion.nombreArchivo }}</mat-card-title>
        <mat-card-subtitle>
          <mat-chip class="materia-chip">{{ planeacion.materia }}</mat-chip>
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <div class="planeacion-info">
          <div class="info-row">
            <mat-icon>event</mat-icon>
            <span>{{ formatDate(planeacion.fechaSubida) }}</span>
          </div>
          <div class="info-row">
            <mat-icon>numbers</mat-icon>
            <span>Versi√≥n {{ planeacion.version }}</span>
          </div>
          <div class="info-row">
            <mat-icon>flag</mat-icon>
            <mat-chip [class]="getEstatusClass(planeacion.estatus)" class="status-chip">
              {{ planeacion.estatus }}
            </mat-chip>
          </div>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <button 
          mat-button 
          color="primary"
          (click)="downloadPlaneacion(planeacion)">
          <mat-icon>download</mat-icon>
          Descargar
        </button>
        
        <button 
          mat-button 
          color="accent"
          *ngIf="planeacion.observaciones"
          (click)="verObservaciones(planeacion)">
          <mat-icon>comment</mat-icon>
          Ver Observaciones
        </button>
      </mat-card-actions>
    </mat-card>

  </div>

  <!-- MENSAJE SI NO HAY PLANEACIONES -->
  <div *ngIf="planeaciones.length === 0" class="no-planeaciones">
    <mat-icon>assignment</mat-icon>
    <p>A√∫n no has subido ninguna planeaci√≥n</p>
    <p class="hint">Selecciona un temario arriba y haz clic en "Subir Planeaci√≥n"</p>
  </div>

  <!-- INSTRUCCIONES -->
  <div class="instructions-card">
    <h3>üìö Instrucciones:</h3>
    <ul>
      <li><strong>Ver Temarios:</strong> Los temarios son documentos base subidos por el administrador</li>
      <li><strong>Descargar Temario:</strong> Descarga el temario para basarte en √©l</li>
      <li><strong>Subir Planeaci√≥n:</strong> Haz clic en "Subir Planeaci√≥n" en cualquier temario</li>
      <li>Selecciona tu archivo PDF de planeaci√≥n (m√°ximo 10MB)</li>
      <li><strong>Estatus:</strong> Tu planeaci√≥n quedar√° como "Pendiente de Revisi√≥n"</li>
      <li>El administrador revisar√° y aprobar√°/rechazar√° tu planeaci√≥n</li>
      <li><strong>Observaciones:</strong> Si hay comentarios, podr√°s verlos haciendo clic en "Ver Observaciones"</li>
      <li>Puedes resubir una planeaci√≥n si fue rechazada (incrementa la versi√≥n)</li>
    </ul>
  </div>

</div>